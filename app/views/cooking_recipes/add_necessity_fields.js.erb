row = $('#add_necessity').closest('.row').before(
  '<%= 
    fields_for(CookingRecipe.new) do |f| 
      fields = f.fields_for(:necessities, Necessity.new, child_index: Necessity.new.object_id) do |nf| 
        render('necessity_fields', f: nf)
      end
      fields.gsub("\n", "").html_safe
    end 
  %>'
);

// Autocomplete on unit text field
$("input[name$='[unit_name]']:last").autocomplete({
  source: $("input[name$='[unit_name]']:last").data('autocomplete-source'),
  autoFocus: true
});

// Autocomplete on ingredient text field
$("input[name$='[ingredient_name]']:last").autocomplete({
  source: $("input[name$='[ingredient_name]']:last").data('autocomplete-source'),
  autoFocus: true
});
